from aes_function import *
from aes_tables import *
from aes_ecb import *


# working example
# array = [0x54, 0x77, 0x6f, 0x20, 0x4f, 0x6e, 0x65, 0x20, 0x4e, 0x69, 0x6e, 0x65, 0x20, 0x54, 0x77, 0x6f]
# key = [0x54, 0x68, 0x61, 0x74, 0x73, 0x20, 0x6d, 0x79, 0x20, 0x4b, 0x75, 0x6e, 0x67, 0x20, 0x46, 0x75]

# key = [0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f]
# array = [0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff]


key = ['a','f','d','s','a','w','e','f','a','w','f','d','a','w','e','1']
array = ['1','3','s','a','s','f','a','f','d','s','a','f',' ','a','w','e']

new_array = []
new_key = []

for i in key:
    new_key.append(ord(i))

for i in array:
    new_array.append(ord(i))

print(new_key)
print(new_array)

# array = [0xf2, 0x01, 0xc6, 0xd4, 0x0a, 0x01, 0xc6, 0xd4, 0x22, 0x01, 0xc6, 0xd4, 0x5c, 0x01, 0xc6, 0xd5]

# key = [0x0f, 0x15, 0x71, 0xc9, 0x47, 0xd9, 0xe8, 0x59, 0x0c, 0xb7, 0xad, 0xd6, 0xaf, 0x7f, 0x67, 0x98]
# round_key = key_expansion128(key)
# n = 0
# for i in round_key:
#     printhex(i)


matrix = aes_encrypt(new_array, 10, new_key)
for i in matrix:
    printhex(i)

list = rewrite_matrix_into_list(matrix)
for i in list:
    print(hex(i), end=' ')
